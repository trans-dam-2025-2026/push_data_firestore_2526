# ğŸ“˜ Documentation â€“ Seeder Firestore (Push Data to Firestore)

Ce projet est un **seeder Firestore** permettant de remplir ou vider votre base Firestore trÃ¨s facilement.
 Il sâ€™intÃ¨gre dans **nâ€™importe quel projet Flutter** utilisant Firebase, Firestore, DTO/ODM.

Lâ€™objectif :
 âœ”ï¸ Injecter rapidement des jeux de donnÃ©es cohÃ©rents dans Firestore
 âœ”ï¸ RÃ©initialiser la base en un clic
 âœ”ï¸ Tester lâ€™application dans un environnement propre
 âœ”ï¸ Manipuler des DTO typÃ©s, pas des Maps
 âœ”ï¸ GÃ©rer facilement des relations et sous-collections

------

# ğŸ§± 1. Installation

## ğŸ“‚ A. TÃ©lÃ©charger ou cloner le projet

Placer le projet push_data_firestore dans le dossier code :

```
/code/push_data_firestore_2526
```

Vous pouvez soit :

```
git clone https://github.com/trans-dam-2025-2026/push_data_firestore_2526.git
```

ou simplement copier/coller le dossier dans votre workspace Flutter.

> ğŸ’¡ Le seeder peut fonctionner comme projet Flutter indÃ©pendant ou Ãªtre fusionnÃ© avec votre projet existant.

------

# ğŸ”¥ 2. Configuration Firebase & Firestore

Avant dâ€™utiliser le seeder, vous devez associer le projet Flutter Ã  Firebase.

## 1. Installer les packages Firebase

```
flutter pub get
```

------

## 2. Ajouter Firebase au projet

Depuis la console Firebase :

1. Se rendre dans la console Firebase dans votre projet.
2. Ajoutez l'application en fonction de votre besoin (Mac/Windows).



------

# ğŸ“‚ 3. Structure du projet

Le seeder contient deux dossiers principaux :

```
lib/
 â”œâ”€â”€ data/
 â””â”€â”€ screens/
```

------

# ğŸ“¦ 4. Le dossier `/lib/data` â€” DÃ©finition des donnÃ©es Ã  seeder

Ce dossier contient toutes les donnÃ©es statiques que vous souhaitez envoyer dans Firestore.

Exemples :

```
lib/data/teams.dart // Exemple de donnÃ©es dans une collection
lib/data/users.dart // Exemple de donnÃ©es dans une collection
lib/data/transactions.dart // Exemple de donnÃ©es dans une sous-collection
```

Chaque fichier contient **vos DTO**, ex :

```
import 'package:dto/models/team.dart';
import 'package:push_data_firestore/data/users.dart';

String generateId() {
  final now = DateTime.now().microsecondsSinceEpoch;
  final random = DateTime.now().millisecondsSinceEpoch.remainder(1000000);
  return '${now.toRadixString(36)}${random.toRadixString(36)}';
}

List<Team> teams = [
  Team(
    id: generateId(),         // ID gÃ©nÃ©rÃ© manuellement
    title: "ğŸ’» Code Magicians",
    picturePath: "assets/img/team-1.png",
    startDate: DateTime(2023, 8, 31),
    users: [users[0].email, users[1].email, users[2].email],
    tags: const ["Coding", "Magic", "Geeks"],
  ),
  // ...
];
```

------

## ğŸ”‘ Pourquoi gÃ©nÃ©rer les IDs manuellement ?

Lâ€™ODM ne renvoie pas lâ€™ID gÃ©nÃ©rÃ© automatiquement lors de lâ€™insertion.
 Donc :

- impossible de crÃ©er facilement des sous-collections,
- impossible de faire des relations fiables.

ğŸ‘‰ Pour un seeder, lâ€™approche correcte est de **gÃ©nÃ©rer lâ€™ID avant insertion**, comme dans lâ€™exemple `generateId()`.
ğŸ‘‰ Cela garantit des donnÃ©es cohÃ©rentes et utilisables immÃ©diatement.

âš ï¸ **Cependant, dans un projet Flutter classique, vous utiliserez normalement la fonction de lâ€™ODM `FirestoreODM.autoGeneratedId()`**, qui gÃ©nÃ¨re automatiquement lâ€™identifiant lors de lâ€™insertion.
 **Mais comme expliquÃ© prÃ©cÃ©demment, cette fonction ne renvoie pas lâ€™ID gÃ©nÃ©rÃ©**, ce qui rend impossible la crÃ©ation dâ€™une sous-collection dÃ©pendante de cet identifiant (puisquâ€™on ne peut pas rÃ©cupÃ©rer lâ€™UID aprÃ¨s lâ€™insertion).

------

# ğŸ›ï¸ 5. Le dossier `/lib/screens` â€” Interface de seed

Le fichier principal est :

```
lib/screens/home.dart
```

Il contient :

- Une interface simple avec **deux boutons** :
   âœ”ï¸ GÃ©nÃ©rer les donnÃ©es
   âœ”ï¸ Supprimer les donnÃ©es
- Les fonctions appelÃ©es pour crÃ©er ou supprimer les donnÃ©es Firestore.

Exemple :

```
FloatingActionButton.extended(
              onPressed: () async {
                await authenticate(); // se connecter
                await addUsers(); // Ajouter des users
                await addTeams(); // Ajouter des Ã©quipes
              },
              label: const Row(
                children: [
                  Icon(Icons.published_with_changes),
                  SizedBox(width: kHorizontalPaddingS),
                  Text("GÃ©nÃ©rer les donnÃ©es"),
                ],
              ),
            )
```

------

# ğŸ¤– 6. Ajouter vos fonctions de seed (ODM)

Pour chaque type de donnÃ©es, vous devez crÃ©er une fonction.

## Exemple : insÃ©rer des teams

```
Future<void> createTeams() async {
  for (final team in teams) {
    await db.teams.insert(team); // ODM insertion
  }
}
```

## Exemple : supprimer les teams

```
Future<void> deleteTeams() async {
  final allTeams = await db.teams.get();

  for (final team in allTeams) {
    await db.teams.delete(team.id);
  }
}
```

------

# ğŸ§© 7. Brancher vos fonctions sur les boutons

Dans `home.dart` :

```
FloatingActionButton.extended(
              onPressed: () async {
                await authenticate();
                await addUsers();
                await addTeams();
              },
              label: const Row(
                children: [
                  Icon(Icons.published_with_changes),
                  SizedBox(width: kHorizontalPaddingS),
                  Text("GÃ©nÃ©rer les donnÃ©es"),
                ],
              ),
            )

FloatingActionButton.extended(
              onPressed: deleteCollections,
              label: const Row(
                children: [
                  Icon(Icons.delete_forever),
                  SizedBox(width: kHorizontalPaddingS),
                  Text("Supprimer les donnÃ©es"),
                ],
              ),
            ),
```

------

# ğŸš€ 8. Comment utiliser le seeder

1. Lancez lâ€™application Flutter
2. Ouvrez lâ€™Ã©cran du seeder
3. Cliquez sur **GÃ©nÃ©rer les donnÃ©es**
4. Firestore est automatiquement rempli avec vos DTO
5. Cliquez sur **Supprimer les donnÃ©es** pour vider les collections

------

# ğŸŒ³ 9. Ajouter des sous-collections

GrÃ¢ce Ã  lâ€™ID manuel, tout est simple :

```
await db.teams.insert(team);
await db.projects.insert(Project(teamId: team.id, ...));
```

------

# ğŸ¯ 10. RÃ©sumÃ©

GrÃ¢ce Ã  ce seeder :

- vous pouvez **gÃ©nÃ©rer nâ€™importe quels jeux de donnÃ©es**
- tout est **typÃ©** via DTO
- vous gardez le contrÃ´le sur les **IDs**
- compatible ODM / Firestore
- utilisation simple via deux boutons

Il s'intÃ¨gre dans **tout projet Flutter** souhaitant automatiser le remplissage de Firestore.
